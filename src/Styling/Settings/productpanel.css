/* ==========================================================================
   Product Panel — Clean layout, simple colors, dark mode, responsive "…"
   ========================================================================== */

/* ---------- Design tokens (light) --------------------------------------- */
:root{
  /* brand & status */
  --accent:      #3b82f6; /* blue-500 */
  --accent-600:  #2563eb; /* blue-600 */
  --accent-700:  #1d4ed8; /* blue-700 */

  --success:     #16a34a; /* green-600 */
  --danger:      #dc2626; /* red-600 */
  --info:        #0ea5e9; /* cyan-500 */

  /* surfaces & text */
  --bg:          #ffffff;
  --surface:     #ffffff;
  --surface-2:   #f8fafc;
  --text:        #0f172a;  /* slate-900 */
  --muted:       #475569;  /* slate-600 */

  /* borders & shadows */
  --line:        #e5e7eb;  /* gray-200 */
  --line-2:      #d1d5db;  /* gray-300 */
  --ring:        0 0 0 3px color-mix(in srgb, var(--accent) 24%, transparent);
  --shadow-1:    0 1px 2px rgba(2,6,23,.05);
  --shadow-2:    0 12px 28px rgba(2,6,23,.15);

  /* radii & spacing */
  --r-sm: .5rem;
  --r-md: .75rem;
  --r-lg: 1rem;
  --gap-1: .5rem;
  --gap-2: .75rem;
  --gap-3: 1rem;
  --gap-4: 1.25rem;
  --gap-5: 1.5rem;
  --gap-6: 2rem;

  /* responsive dots trigger */
  --dots-size: 20px;
  --dots-right: .9rem;
}

/* scale the dots a touch on very small screens */
@media (max-width: 860px){  :root{ --dots-size: 38px; --dots-right: .8rem; } }
@media (max-width: 640px){  :root{ --dots-size: 36px; --dots-right: .75rem; } }
@media (max-width: 420px){  :root{ --dots-size: 34px; --dots-right: .6rem; } }

/* ---------- Design tokens (dark) ---------------------------------------- */
@media (prefers-color-scheme: dark){
  :root{
    --bg:        #0b1220;
    --surface:   #0f162a;
    --surface-2: #111b2f;
    --text:      #e5e7eb;
    --muted:     #a7b0c0;

    --line:      #243048;
    --line-2:    #2e3b57;
  }
}

/* ---------- Panels ------------------------------------------------------ */
.panel{
  background: var(--surface);
  border: 1px solid var(--line);
  border-radius: 14px;
  padding: var(--gap-6);
  margin-bottom: var(--gap-6);
}

.panel h3{
  margin: 0 0 var(--gap-4);
  display: flex;
  align-items: center;
  gap: .6rem;
  font: 700 1.05rem/1.2 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  color: var(--text);
}

.panel .panel-icon{
  width: 36px; height: 36px;
  border-radius: 10px;
  display: grid; place-items: center;
  color: #fff; background: var(--accent);
  box-shadow: 0 2px 10px color-mix(in srgb, var(--accent) 25%, transparent);
  font-size: 1rem;
}

/* ---------- Forms ------------------------------------------------------- */
.product-form .form-group{ margin-bottom: var(--gap-4); }
.form-group label{
  display: block;
  margin-bottom: .45rem;
  color: var(--muted);
  font-size: .82rem;
  font-weight: 600;
  letter-spacing: .015em;
}

/* inputs */
.panel input,
.panel select,
.panel textarea{
  width: 100%;
  box-sizing: border-box;
  background: var(--surface);
  color: var(--text);
  border: 1px solid var(--line-2);
  border-radius: 12px;
  padding: .7rem .9rem;
  font-size: .95rem;
  transition: border .15s ease, box-shadow .15s ease, background .15s ease;
}
.panel textarea{ min-height: 110px; line-height: 1.5; }

.panel input:hover,
.panel select:hover,
.panel textarea:hover{ border-color: #cbd5e1; }

.panel input:focus,
.panel select:focus,
.panel textarea:focus{
  outline: none;
  border-color: var(--accent);
  box-shadow: var(--ring);
}

/* placeholders (light & dark) */
.panel input::placeholder,
.panel textarea::placeholder,
.product-list .search::placeholder{
  color: var(--muted);
  opacity: .7;
}

/* validation */
.input-error{
  border-color: var(--danger) !important;
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--danger) 22%, transparent) !important;
}
.field-error{ margin-top: .4rem; color: var(--danger); font-size: .82rem; }

/* ---------- Grid helpers ------------------------------------------------ */
.grid{ display: grid; gap: var(--gap-3); }
.two-cols{ grid-template-columns: repeat(2, minmax(0,1fr)); }
.three-cols{ grid-template-columns: repeat(3, minmax(0,1fr)); }
@media (max-width: 980px){ .two-cols, .three-cols{ grid-template-columns: 1fr; } }

/* ---------- Uploads ----------------------------------------------------- */
.file-btn{
  position: relative;
  display: inline-flex; align-items: center; gap: .55rem;
  padding: .6rem 1rem;
  border-radius: 12px;
  border: 1px solid var(--line-2);
  background: var(--surface);
  color: var(--text);
  font-weight: 700; font-size: .9rem; cursor: pointer;
  box-shadow: var(--shadow-1);
  transition: transform .08s ease, box-shadow .2s ease, border-color .15s ease;
}
.file-btn:hover{ transform: translateY(-1px); box-shadow: var(--shadow-2); border-color: #cbd5e1; }
.file-btn input[type="file"]{ position: absolute; inset: 0; opacity: 0; cursor: pointer; }

.photo-row{
  margin-top: .5rem;
  display: flex; flex-wrap: wrap; gap: .6rem;
  padding: var(--gap-3);
  border: 1px dashed var(--line-2);
  border-radius: 12px;
  background: var(--surface-2);
  min-height: 120px; align-items: center; justify-content: center;
}
.photo-row.drag-over{ border-color: var(--accent); }
.empty-photos{ color: var(--muted); font-size: .9rem; font-style: italic; }

.thumb{
  position: relative; width: 88px; height: 88px;
  border: 1px solid var(--line-2); border-radius: 10px; overflow: hidden;
  background: var(--surface); box-shadow: var(--shadow-1);
  cursor: pointer; transition: transform .12s ease, box-shadow .2s ease, border-color .15s ease;
}
.thumb:hover{ transform: translateY(-2px); box-shadow: var(--shadow-2); border-color: #cbd5e1; }
.thumb.selected{ border-color: var(--accent); box-shadow: var(--ring); }
.thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
.thumb button{
  position: absolute; top: 6px; right: 6px; width: 22px; height: 22px;
  display: grid; place-items: center; border: none; border-radius: 999px;
  background: rgba(15,23,42,.85); color: #fff; font-weight: 700;
  opacity: 0; transition: opacity .15s ease, transform .1s ease;
}
.thumb:hover button{ opacity: 1; }
.thumb button:hover{ transform: scale(1.06); background: var(--danger); }

/* ---------- Form actions ----------------------------------------------- */
.actions{ display: flex; gap: .6rem; margin-top: var(--gap-4); }
.actions .primary,
.actions .secondary{
  flex: 1; min-height: 44px;
  border-radius: 12px; font-weight: 800; font-size: .95rem;
  border: 1px solid transparent;
  transition: transform .08s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
}
.actions .primary{ color:#fff; background: var(--accent); }
.actions .primary:hover:not(:disabled){ transform: translateY(-1px); background: var(--accent-600); }
.actions .secondary{ background: var(--surface); color: var(--text); border-color: var(--line-2); }
.actions .secondary:hover{ background: var(--surface-2); }
.actions button:disabled{ opacity: .6; cursor: not-allowed; transform: none; }

/* ---------- Product list ------------------------------------------------ */
.product-list{
  background: var(--surface);
  border: 1px solid var(--line);
  border-radius: 14px;
  box-shadow: var(--shadow-1);
  padding: var(--gap-6);
}
.product-list .search{
  margin-bottom: var(--gap-4);
  width: 100%; padding: .7rem .9rem;
  border: 1px solid var(--line-2); border-radius: 12px;
  background: var(--surface); color: var(--text); font-size: .95rem;
}
.product-list .search:focus{ outline: none; border-color: var(--accent); box-shadow: var(--ring); }

.product-list ul{ list-style: none; margin: 0; padding: 0; border-radius: 12px; overflow: visible; }
.product-list li{
  position: relative;                           /* anchor for dots/menu */
  display: flex; align-items: center; justify-content: space-between; gap: 1rem;
  padding: .9rem 1rem; background: var(--surface); border-bottom: 1px solid var(--line);
}
.product-list li:last-child{ border-bottom: none; }
.product-list li:hover{ background: var(--surface-2); }

.row-main{ min-width: 0; position: relative; margin-right: 200px;}
.product-name{ font-weight: 800; color: var(--text); margin-bottom:.35rem; margin-right: -200px;}
.product-name .product-brand{ color: var(--muted); font-weight: 700; }

/* Default details layout (desktop): inline row */
.product-details{ display: flex; flex-wrap: wrap; gap: .65rem; color: var(--muted); font-size: .88rem; }
.product-details .price{ color: var(--success); font-weight: 800; }
.product-details .quantity{ color: #d97706; font-weight: 800; }

/* ---------- Row actions ------------------------------------------------- */
.row-actions{ display: flex; align-items: center; gap: .45rem; margin-left: auto; position: static; }

/* desktop buttons (flat, simple) */
.btns{ display: flex; gap: .45rem; flex-wrap: wrap; }
.btns button{
  padding: .5rem .85rem; border-radius: 10px;
  font-weight: 800; font-size: .88rem;
  border: 1px solid transparent; cursor: pointer;
  transition: transform .08s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
}
.btns button:hover{ transform: translateY(-1px); }
.btns .edit   { background: var(--accent);  color:#fff; }
.btns .delete { background: var(--danger);  color:#fff; }
.btns .pin    { background: var(--info) !important;    color:#fff !important; border:none !important; }
.btns .sale   { background: var(--success) !important; color:#fff !important; border:none !important; }
.btns .pin.loading, .btns .sale.loading{ opacity: .75; cursor: progress; }

/* prevent accidental duplicates from legacy markup */
.product-list li .btns:not(:first-of-type){ display:none !important; }

/* ---------- Dots trigger (centered right on all small screens) ---------- */
/* Base style (hidden by default, positioned for when enabled) */
.more-trigger{
  position: absolute;
  right: var(--dots-right);
  top: 50%;
  transform: translateY(-50%);
  width: var(--dots-size);
  height: var(--dots-size);
  border: 1px solid var(--line-2);
  color: var(--text);
  font-weight: 900; font-size: 20px; line-height: 1;
  cursor: pointer;
  display: none; /* shown via media rules below */
  align-items: center; justify-content: center;
  transition: transform .08s ease, box-shadow .2s ease, border-color .15s ease, background .15s ease;
}
.more-trigger:hover{ transform: translateY(-50%) translateY(-1px); box-shadow: var(--shadow-2); border-color:#cbd5e1; }
.more-trigger:focus-visible{ outline: none; box-shadow: var(--ring); }

/* give content room so the dots never overlap */
@media (max-width: 1156px){
  .product-list li{ padding-right: calc(var(--dots-size) + 1.2rem); }
}

/* also add padding on very narrow devices */
@media (max-width: 640px){
  .product-list li{ padding-right: calc(var(--dots-size) + 1rem); }
}

/* ---------- Popover menu (for tablet/small laptop) ---------------------- */
.action-menu{
  position: absolute;
  right: var(--dots-right);
  top: 50%;
  transform: translateY(-50%);      /* align with the dots vertically */
  min-width: 200px;
  padding: 6px;
  border: 1px solid var(--line-2);
  border-radius: 12px;
  background: var(--surface);
  box-shadow: var(--shadow-2);
  z-index: 50;
}
.menu-item{
  width: 100%;
  text-align: left;
  padding: 10px 12px;
  border-radius: 8px;
  background: transparent;
  border: 0;
  cursor: pointer;
  font-weight: 700;
  color: var(--text);
  transition: background .12s ease, transform .04s ease;
}
.menu-item:hover{ background: var(--surface-2); }
.menu-item:disabled{ opacity: .55; cursor: not-allowed; }
.menu-item:active{ transform: translateY(1px); }
.menu-delete { color: var(--danger);  }
.menu-sale   { color: var(--success); }
.menu-pin    { color: var(--info);    }

/* ---------- Breakpoints: control which control set is visible ----------- */
/* Desktop (buttons visible; dots/menu hidden) */
@media (min-width: 1157px){
  .row-actions .btns{ display: flex !important; }
  .row-actions .more-trigger{ display: none !important; }
  .row-actions .action-menu{ display: none !important; }
}

/* ≤1156px: show dots, stack details vertically */
@media (max-width: 1156px){
  .row-actions .btns{ display: none !important; }
  .row-actions .more-trigger{ display: inline-flex !important; }
  .product-details{ flex-direction: column; align-items:flex-start; gap:.45rem; }
}

/* Stack the row on very narrow screens */
@media (max-width: 860px){
  .product-list li{ flex-direction: column; align-items: flex-start; }
  .row-actions{ align-self: stretch; }
}

/* ---------- Empty / loading ------------------------------------------- */
.no-results{
  text-align: center; padding: 1.5rem; color: var(--muted);
  background: var(--surface-2);
  border: 1px dashed var(--line-2); border-radius: 12px; margin-top: .5rem;
}
.loading-state{ text-align: center; padding: 2rem; color: var(--muted); }
.loading-spinner{
  width: 30px; height: 30px; border: 3px solid #e2e8f0; border-top-color: var(--accent);
  border-radius: 999px; animation: spin 1s linear infinite; margin: 0 auto;
}
@keyframes spin{ to { transform: rotate(360deg); } }

/* ---------- Error block ------------------------------------------------ */
.panel.error{ border-color: color-mix(in srgb, var(--danger) 35%, #fff); background: color-mix(in srgb, var(--danger) 6%, #fff); }
.error-message{
  position: relative; display: flex; gap: .75rem; align-items: flex-start;
  padding: .9rem 1rem; border: 1px solid color-mix(in srgb, var(--danger) 25%, #fff);
  border-radius: 12px; background: color-mix(in srgb, var(--danger) 6%, #fff);
}
.error-icon{ font-size: 1.1rem; }
.error-message h4{ margin: .1rem 0 .25rem; color: #991b1b; }
.error-message p{ margin: 0; color: #b91c1c; }
.error-close{
  position: absolute; top: .45rem; right: .45rem;
  width: 28px; height: 28px; border: none; border-radius: 999px; background: transparent;
  color: #991b1b; font-size: 1rem; cursor: pointer;
}
.error-close:hover{ background: rgba(220,38,38,.08); }

/* ---------- A11y focus ------------------------------------------------- */
.panel input:focus-visible,
.panel select:focus-visible,
.panel textarea:focus-visible,
.file-btn:focus-visible,
.thumb:focus-visible,
.actions button:focus-visible,
.btns button:focus-visible,
.more-trigger:focus-visible{ outline: none; box-shadow: var(--ring); }

/* ---------- Bottom sheet (phones) -------------------------------------- */
/* These styles remain the same; included here for completeness */
.no-scroll{ overflow: hidden; }
.bsheet{ position: fixed; inset: 0; z-index: 60; display: none; }
.bsheet.is-open{ display: block; }
.bsheet-backdrop{
  position: absolute; inset: 0; background: rgba(2,6,23,.55); backdrop-filter: blur(2px);
}
.bsheet-panel{
  position: absolute; left: 0; right: 0; bottom: 0;
  background: var(--surface);
  border-top-left-radius: 16px; border-top-right-radius: 16px;
  box-shadow: 0 -20px 60px rgba(2,6,23,.35);
  padding: 14px 16px 18px;
}
.bsheet-handle{
  width: 48px; height: 5px; border-radius: 999px; margin: 4px auto 10px;
  background: var(--line-2);
}
.bsheet-header{ text-align:center; margin-bottom:10px; }
.bsheet-title{ margin:0; font-weight:800; color:var(--text); }
.bsheet-sub{ color: var(--muted); font-size:.9rem; margin-top:2px; }
.bsheet-actions{ display:flex; flex-direction:column; gap:8px; }
.sheet-btn{
  width:100%; min-height:42px; border-radius:12px; border:1px solid var(--line-2);
  background:var(--surface); color:var(--text); font-weight:800;
}
.sheet-btn.primary{ background:var(--accent); color:#fff; border-color:transparent; }
.sheet-btn.danger{ color:var(--danger); }
.sheet-btn.info{ color:var(--info); }
.sheet-btn.success{ color:var(--success); }
.bsheet-footer{ margin-top:10px; text-align:center; }
.sheet-close{
  min-height:40px; width:100%; border-radius:12px; border:1px solid var(--line-2);
  background:var(--surface-2); color:var(--text); font-weight:800;
}
